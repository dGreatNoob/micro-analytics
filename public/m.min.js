/**
 * Microlytics v1.0.0 - Privacy-first analytics
 * @license MIT
 */
!function(){"use strict";var e={apiEndpoint:"/api/track",debug:!1},t=document.currentScript||document.querySelector("script[data-site]");if(!t)return void console.warn("Microlytics: Script tag not found");var n=t.getAttribute("data-site");if(!n)return void console.warn("Microlytics: data-site attribute is required");function i(){e.debug&&console.log("[Microlytics]",...arguments)}function r(){try{var e=(new Date).toISOString().split("T")[0],t=document.createElement("canvas"),n=t.getContext("2d");if(!n)return o(`${screen.width}x${screen.height}-${e}-${navigator.userAgent.substring(0,50)}`);return n.textBaseline="top",n.font='14px "Arial"',n.textBaseline="alphabetic",n.fillStyle="#f60",n.fillRect(125,1,62,20),n.fillStyle="#069",n.fillText("Microlytics üîç",2,15),n.fillStyle="rgba(102, 204, 0, 0.7)",n.fillText("Analytics",4,17),o(`${o(t.toDataURL())}-${e}`)}catch(t){return o(`${Math.random()}-${Date.now()}-${(new Date).toISOString().split("T")[0]}`)}}function o(e){for(var t=0,n=0;n<e.length;n++){var i=e.charCodeAt(n);t=(t<<5)-t+i,t&=t}return Math.abs(t).toString(36)}function a(){return i("Collected data:",d={siteId:n,pathname:window.location.pathname,hostname:window.location.hostname,referrer:document.referrer||null,userAgent:navigator.userAgent,language:navigator.language||navigator.userLanguage,screenWidth:screen.width,screenHeight:screen.height,timestamp:(new Date).toISOString(),visitorId:r()}),d;var d}function s(t){var n=e.apiEndpoint,r=JSON.stringify(t);try{if(navigator.sendBeacon){var o=new Blob([r],{type:"application/json"});if(navigator.sendBeacon(n,o))return i("Pageview sent via sendBeacon"),!0;i("sendBeacon failed, trying fetch...")}return fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:r,keepalive:!0}).then(function(e){e.ok?i("Pageview sent via fetch"):i("Server responded with error:",e.status)}).catch(function(e){i("Fetch failed:",e)}),!0}catch(e){return i("Error sending pageview:",e),!1}}function c(){try{i("Initializing Microlytics for site:",n),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",u):u()}catch(t){e.debug&&console.error("Microlytics initialization error:",t)}}function u(){try{var t=a();s(t)}catch(t){e.debug&&console.error("Microlytics tracking error:",t)}}window.microlytics=window.microlytics||{track:function(e,t){i("Custom event tracking will be available in Phase 5")},trackPageview:u},c()}();


